# М.Видео-Эльдорадо — Тестовое задание

## Задание:
### Вводные

Есть файл (recommends.csv) с данными по рекомендациям одних товаров к другим, по одной рекомендации на строку:

sku1,recom1,0.1

sku2,recom2,0.2

…

Последний столбец содержит вероятность правильной рекомендации, то есть “близость” рекомендованного товара к исходному (чем больше значение — тем больше “близость”). 

Важно: хотя, в указанном файле кол-во рекомендаций на один товар не превышает 50, оно может быть соразмерно кол-ву самих товаров.

### ТЗ:

Написать Web API на Python с одним эндпоинтом, который принимает sku в качестве параметра и возвращает список всех товаров, рекомендованных для этого sku. Должна быть возможность указать опциональный параметр минимального порога близости для рекомендаций. 
Продумать стратегию масштабирования сервиса при увеличении нагрузки, а также дать примерную оценку потребления ресурсов в случае, если размер данных по рекомендациям начнет расти.
 

### Ограничения на решение:

* Задача должна быть решена без использования сторонних библиотек и сервисов (вроде баз данных). Допустимо использование только стандартной библиотеки Python.
* Модуль sqlite3 использовать нельзя.
* Максимальное время ответа API на запрос — 500 мс.
* При выборе между меньшей скоростью ответа на запрос и меньшим потреблением оперативной памяти предпочтение отдавать меньшей скорости ответа.
 

### Критерии оценки:

* Следование лучшим практикам при организации проекта.
* Кодстайл.
* Общее качество кода.
* Время ответа API на запрос.
* Потребление оперативной памяти.
 

## Что было предпринято для решения:
На выполнение задания было потрачено примерно 10-12 часов.
* В течение первого дня (16 февраля) задание было подробно изучено и проведены ряд тестов, чтобы понять
скорость отклика при различной обработке файла recommends.csv, остановился на варианте заполнения словаря данными из 
файла. Предварительно также было посчитано количество строк (60 миллионов), так как Excel и другие программы считывали
не более 1 миллиона строк за раз. На это было потрачено 2 часа
* В течение второго дня (17 февраля) был написан парсер таблицы по конкретному SKU-ключу, отклик менее 100мс, затрачено
примерно 3-4 часа, сильно уменьшило размер кода использование defaultdict()
* В течение третьего дня (18 февраля) было много времени потрачено на изучение стандартной бибилоетки Python
для реализации Web API с одним эндпоинтом, было затрачено около 4 часов. Самым сложным было нахождения переменной для
считывания параметров запроса. Также был добавлен необязательный параметр index.
* В течение четвертого дня правился кодстайл, оценивались возможности масштабирования, а также
подготавилался данный текстовый файл со всей информацией. 2 часа

### Запуск скрипта
Запустите файл recommends.py (в одной папке также должен находится recommends.csv - https://yadi.sk/d/NG-huzs-X-5U5Q), дождитесь загрузки данных 
(ожидайте сообщения в терминале). Далее можно выполнять запросы

## Cтратегия масштабирования сервиса и примерная оценка потребления ресурсов

60 миллионый файл занимает примерно 1 ГБ оперативной памяти, запрос обрабатывается парсером в среднем
меньше чем за 50мс, то есть расширение исходных данных в 10 раз не должно вызвать затрудения в работе.
Точную оценку давать сложно так как все зависит от оборудования, на котором запускается скрипт.
В данном случае использовались 16ГБ оперативной памяти и процессор M1. 
